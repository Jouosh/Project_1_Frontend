<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complain Away</title>
</head>

<body>
    
    <h1>Register Your Complaint Here!</h1>

    <form action = "" method = "post">
        <fieldset>
            <legend>Complaint Information:</legend>
            
            <label for = "inputDescription">Description</label>
            <input id = "inputDescription" type = "text" required minlength = "5" maxlength="500"/>
        </fieldset>
        <button id = "submitBtn">Submit</button>
    </form>

</body>
<script>

    //Get needed element
    const inputDescription = document.getElementById("inputDescription");

    document.addEventListener("submit", async event => {

        //Stop default event from happening
        event.preventDefault();
        
        //get description from input and make a new complaint object
        const description = inputDescription.value;
        const complaint = {complaintId: 0, description, meeting: -1, status: "PENDING"};

        //Send complaint post request to back end
        const responses = await fetch("http://localhost:8080/complaints", {
            method:"POST",
            body: JSON.stringify(complaint),
            headers: {
                "Content-Type": "application/json"
            }
        });

        //Alert based on how things go
        if (responses.status === 201) {
            alert("Successfully created a complaint!");
            inputDescription.value = "";
        } else {
            alert("Something went wrong");
        }

    });

</script>

</html>